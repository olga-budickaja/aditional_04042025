{% extends 'main/base.html' %}
{% block content %}

{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'main/css/index.css' %}" />
<link rel="stylesheet" href="{% static 'main/css/product_page.css' %}" />
<link rel="stylesheet" href="{% static 'main/css/form.css' %}" />
<script src="{% static 'main/js/modal.js'%}" defer></script>
<script src="{% static 'main/js/tab.js'%}" defer></script>
{% endblock %}

<div class="product_page">
  <ul class="breadcrumbs">
    <li><a href="{% url 'main' %}">–ì–æ–ª–æ–≤–Ω–∞</a>/</li>
    <li>{{product.name}}</li>
  </ul>
  <div class="product_wrap">
    {% if product.image %}
    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="img" />
    {% else %}
    <img
      src="{% static 'main/images/no-image.webp' %}"
      alt="{{ product.name }}"
      class="img"
    />
    {% endif %}
    <div class="content_page">
      <h1 class="title">{{ product.name }}</h1>
      <p class="price">{{ product.price }} ‚Ç¥</p>
      <button class="btn">–ö—É–ø–∏—Ç–∏</button>
    </div>
  </div>
  <div class="tabs">
    <div class="tab-buttons">
      <button class="tab-btn active" data-tab="desc">–û–ø–∏—Å —Ç–æ–≤–∞—Ä—É</button>
      <button class="tab-btn" data-tab="attrs">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</button>
      <button class="tab-btn" data-tab="comments">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ</button>
    </div>

    <div class="tab-content active" id="desc">
      <h2 class="subtitle">–û–ø–∏—Å —Ç–æ–≤–∞—Ä—É</h2>
      <p>{{ product.description }}</p>
    </div>

    <div class="tab-content" id="attrs">
      <h2 class="subtitle">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h2>
      <table class="attributes-table">
        {% for attr in attributes %}
        <tr>
          <td class="attr-name">{{ attr.name }}:</td>
          <td class="attr-value">{{ attr.value }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="tab-content" id="comments">
      <h2 class="subtitle">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ</h2>
      {% for comment in product.comments.all %}
      <div class="product_comment">
        <div class="comment_header">
          {% if comment.author %}
          <h3 class="comment_author">{{ comment.author }}</h3>
          {% else %}
          <h3 class="comment_author">–ê–Ω–æ–Ω—ñ–º</h3>
          {% endif %}
          <span class="subtitle">{{ comment.created_at }}</span>
        </div>
        <div class="comment_content">
          <div class="comment_image">
            {% if comment.image %}
            <img src="{{ comment.image.url }}" alt="–ú–∞–ª—é–Ω–æ–∫ –¥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ—é" />
            {% else %}
            <img
              src="{% static 'main/images/no_image_comment.png' %}"
              alt="{{ product.name }}"
              class="img"
            />
            {% endif %}
          </div>
          <div class="comment_text">{{comment.text}}</div>
        </div>
      </div>
      {% endfor %}
      <h2 class="subtitle">–î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</h2>
      <form
        action="{% url 'create_comment' %}"
        method="post"
        enctype="multipart/form-data"
        class="form"
      >
        {% csrf_token %}
        <input
          name="author"
          type="text"
          class="form_control"
          placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)"
        />
        <textarea
          name="text"
          class="form_control"
          placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä"
        ></textarea>
        <input
          type="hidden"
          class="form_control"
          name="product_id"
          value="{{product.id}}"
        />
        <div class="form_buttons">
          <label for="file_upload" class="btn_round">
            <span>üìÇ</span>
            <input
              type="file"
              name="image"
              id="file_upload"
              class="form_file"
            />
          </label>
          <button type="reset" class="btn_round">üîÉ</button>
          <button type="submit" class="btn_round">üì©</button>
        </div>
      </form>
    </div>
  </div>

  {% endblock %} {% block modals %}
  <div class="bg">
    <div class="modal">
      <form
        action="{% url 'create_order' %}"
        method="post"
        enctype="multipart/form-data"
        class="form"
      >
        {% csrf_token %}
        <input
          class="input"
          name="name"
          type="text"
          placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è"
        />
        <input
          type="hidden"
          class="form_control"
          name="product_id"
          value="{{ product.id }}"
        />
        <input
          class="input"
          name="phone"
          type="text"
          placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
          value="+380999999999"
        />
        <button type="submit" class="btn">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>
      </form>
    </div>
  </div>
  {% endblock %}
</div>
